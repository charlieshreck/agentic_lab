apiVersion: v1
kind: ConfigMap
metadata:
  name: litellm-config
  namespace: ai-platform
  labels:
    app: litellm
data:
  config.yaml: |
    # LiteLLM Proxy Configuration
    # See: https://docs.litellm.ai/docs/proxy/configs
    #
    # Gemini Flash Only - FREE TIER
    # WARNING: Do not use Pro models without budget controls

    model_list:
      # Gemini 2.0 Flash - Multiple keys for load balancing
      # Each key has 1500 RPD, 10 RPM on free tier
      - model_name: gemini/gemini-2.0-flash
        litellm_params:
          model: gemini/gemini-2.0-flash
          api_key: os.environ/GEMINI_API_KEY
      - model_name: gemini/gemini-2.0-flash
        litellm_params:
          model: gemini/gemini-2.0-flash
          api_key: os.environ/GEMINI_API_KEY_2

      # Embedding model - load balanced
      - model_name: embeddings
        litellm_params:
          model: gemini/text-embedding-004
          api_key: os.environ/GEMINI_API_KEY
      - model_name: embeddings
        litellm_params:
          model: gemini/text-embedding-004
          api_key: os.environ/GEMINI_API_KEY_2

      # Aliases all point to 2.0-flash
      - model_name: gemini-pro
        litellm_params:
          model: gemini/gemini-2.0-flash
          api_key: os.environ/GEMINI_API_KEY
      - model_name: gemini-pro
        litellm_params:
          model: gemini/gemini-2.0-flash
          api_key: os.environ/GEMINI_API_KEY_2

      - model_name: gemini/gemini-2.0-pro
        litellm_params:
          model: gemini/gemini-2.0-flash
          api_key: os.environ/GEMINI_API_KEY
      - model_name: gemini/gemini-2.0-pro
        litellm_params:
          model: gemini/gemini-2.0-flash
          api_key: os.environ/GEMINI_API_KEY_2

    # Router settings - NO RETRIES to prevent cost runaway
    router_settings:
      routing_strategy: simple-shuffle
      num_retries: 0
      timeout: 60
      fallbacks: []

    # General settings
    general_settings:
      master_key: null
      drop_params: true

    # Logging - track all requests to catch abuse
    litellm_settings:
      set_verbose: false
      json_logs: true
      store_audit_logs: true
      request_timeout: 60

    # Log every request with caller info
    environment_variables:
      LITELLM_LOG_LEVEL: INFO
